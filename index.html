<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº‰øÆÁêÜÁõ∏Ë´áAI</title>
    <style>
      body {
        font-family: 'Hiragino Sans', '„Éí„É©„ÇÆ„ÉéËßí„Ç¥„Ç∑„ÉÉ„ÇØ', 'Yu Gothic', '„É°„Ç§„É™„Ç™', sans-serif;
        margin: 0;
        padding: 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
        color: white;
      }

      .header h1 {
        font-size: 2.5em;
        margin: 0;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      }

      .header p {
        font-size: 1.2em;
        margin: 10px 0;
        opacity: 0.9;
      }

      .chat-container {
        background: rgba(255,255,255,0.95);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        margin-bottom: 20px;
      }

      .chat-messages {
        height: 500px;
        overflow-y: auto;
        border: 2px solid #e0e0e0;
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 20px;
        background: #fafafa;
      }

      .message {
        margin-bottom: 20px;
        padding: 15px;
        border-radius: 15px;
        max-width: 80%;
        word-wrap: break-word;
        line-height: 1.6;
      }

      .user-message {
        background: linear-gradient(45deg, #667eea, #764ba2);
        color: white;
        margin-left: auto;
        text-align: right;
      }

      .ai-message {
        background: white;
        border: 2px solid #e0e0e0;
        margin-right: auto;
      }

      .chat-input {
        display: flex;
        gap: 10px;
      }

      .chat-input input {
        flex: 1;
        padding: 15px;
        border: 2px solid #e0e0e0;
        border-radius: 25px;
        font-size: 16px;
        outline: none;
        transition: border-color 0.3s ease;
      }

      .chat-input input:focus {
        border-color: #667eea;
      }

      .chat-input button {
        padding: 15px 30px;
        background: linear-gradient(45deg, #667eea, #764ba2);
        color: white;
        border: none;
        border-radius: 25px;
        font-size: 16px;
        cursor: pointer;
        transition: transform 0.2s ease;
      }

      .chat-input button:hover {
        transform: translateY(-2px);
      }

      .chat-input button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .loading {
        display: none;
        text-align: center;
        padding: 20px;
        color: #666;
      }

      .loading.show {
        display: block;
      }

      .spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #667eea;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 1s linear infinite;
        margin: 0 auto 10px;
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      .support-center-info {
        background: rgba(255,255,255,0.95);
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        border-left: 5px solid #e74c3c;
      }

      .support-center-info h2 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.5em;
        text-align: center;
      }

      .support-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
      }

      .info-item {
        background: #f8f9fa;
        padding: 12px 15px;
        border-radius: 8px;
        border-left: 3px solid #3498db;
        font-size: 0.95em;
      }

      .info-item strong {
        color: #2c3e50;
        display: inline-block;
        margin-right: 8px;
      }

      .contact-form-btn {
        color: #3498db;
        text-decoration: none;
        font-weight: bold;
        padding: 8px 15px;
        background: linear-gradient(45deg, #f39c12, #e67e22);
        color: white;
        border-radius: 8px;
        display: inline-block;
        margin-left: 10px;
        transition: all 0.3s ease;
        box-shadow: 0 2px 5px rgba(243, 156, 18, 0.3);
      }

      .contact-form-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(243, 156, 18, 0.4);
        background: linear-gradient(45deg, #e67e22, #d35400);
      }

      /* Èñ¢ÈÄ£„Éñ„É≠„Ç∞„Çª„ÇØ„Ç∑„Éß„É≥„ÅÆ„Çπ„Çø„Ç§„É´ */
      .related-blogs {
        display: none; /* AI„ÅÆÂõûÁ≠îÂÜÖ„Å´ÁµÑ„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Çã„Åü„ÇÅÈùûË°®Á§∫ */
        background: rgba(255,255,255,0.95);
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        border-left: 5px solid #27ae60;
      }

      .related-blogs h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.3em;
        text-align: center;
      }

      .blog-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 15px;
      }

      .blog-card {
        background: white;
        border-radius: 10px;
        padding: 15px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        border-left: 4px solid #27ae60;
      }

      .blog-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 15px rgba(0,0,0,0.15);
      }

      .blog-title {
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 8px;
        font-size: 1.1em;
        line-height: 1.4;
      }

      .blog-excerpt {
        color: #666;
        font-size: 0.9em;
        margin-bottom: 10px;
        line-height: 1.5;
      }

      .blog-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.8em;
        color: #888;
      }

      .blog-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
      }

      .blog-tag {
        background: #ecf0f1;
        color: #2c3e50;
        padding: 2px 6px;
        border-radius: 10px;
        font-size: 0.75em;
      }

      .links-section {
        background: rgba(255,255,255,0.95);
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        border-left: 5px solid #3498db;
      }

      .links-section h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.3em;
        text-align: center;
      }

      .links-section a {
        color: #3498db;
        text-decoration: none;
        font-weight: bold;
        display: inline-block;
        margin: 5px 10px;
        padding: 5px 10px;
        background: #ecf0f1;
        border-radius: 5px;
        transition: background-color 0.3s ease;
      }

      .links-section a:hover {
        text-decoration: underline;
      }

      /* „Çµ„Éù„Éº„Éà„Çª„É≥„Çø„ÉºÊÉÖÂ†±„ÅÆ„Çπ„Çø„Ç§„É´ */
      .support-center-info {
        background: rgba(255,255,255,0.95);
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        border-left: 5px solid #e74c3c;
      }

      .support-center-info h2 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.5em;
        text-align: center;
      }

      .support-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
      }

      .info-item {
        background: #f8f9fa;
        padding: 12px 15px;
        border-radius: 8px;
        border-left: 3px solid #3498db;
        font-size: 0.95em;
      }

      .info-item strong {
        color: #2c3e50;
        display: inline-block;
        margin-right: 8px;
      }

      .contact-form-btn {
        color: #3498db;
        text-decoration: none;
        font-weight: bold;
        padding: 8px 15px;
        background: linear-gradient(45deg, #f39c12, #e67e22);
        color: white;
        border-radius: 8px;
        display: inline-block;
        margin-left: 10px;
        transition: all 0.3s ease;
        box-shadow: 0 2px 5px rgba(243, 156, 18, 0.3);
      }

      .contact-form-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(243, 156, 18, 0.4);
        background: linear-gradient(45deg, #e67e22, #d35400);
      }

      /* „É¨„Çπ„Éù„É≥„Ç∑„Éñ„Éá„Ç∂„Ç§„É≥ */
      @media (max-width: 768px) {
        .container {
          padding: 10px;
        }

        .header h1 {
          font-size: 2em;
        }

        .chat-container {
          padding: 20px;
        }

        .chat-messages {
          height: 400px;
        }

        .message {
          max-width: 90%;
        }

        .chat-input {
          flex-direction: column;
        }

        .chat-input input {
          margin-bottom: 10px;
        }
      }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöê „Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº‰øÆÁêÜÁõ∏Ë´áAI</h1>
            <p>Â∞ÇÈñÄÁöÑ„Å™‰øÆÁêÜ„Ç¢„Éâ„Éê„Ç§„Çπ„Å®„Çµ„Éù„Éº„Éà„ÇíÊèê‰æõ„Åó„Åæ„Åô</p>
        </div>

        <!-- „Çµ„Éù„Éº„Éà„Çª„É≥„Çø„ÉºÊÉÖÂ†± -->
        <div class="support-center-info">
            <h2>üè¢ Â≤°Â±±„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº‰øÆÁêÜ„Çµ„Éù„Éº„Éà„Çª„É≥„Çø„Éº</h2>
            <div class="support-details">
                <div class="info-item">
                    <strong>üìû ÈõªË©±:</strong> 086-XXX-XXXX
                </div>
                <div class="info-item">
                    <strong>üìß „É°„Éº„É´:</strong> info@camper-repair.net
                </div>
                <div class="info-item">
                    <strong>üïí Âñ∂Ê•≠ÊôÇÈñì:</strong> Âπ≥Êó• 9:00-18:00
                </div>
                <div class="info-item">
                    <strong>üìç ÊâÄÂú®Âú∞:</strong> Â≤°Â±±ÁúåÂ≤°Â±±Â∏Ç
                </div>
            </div>
            <div style="text-align: center; margin-top: 15px;">
                <a href="https://camper-repair.net/contact/" class="contact-form-btn" target="_blank">
                    „ÅäÂïè„ÅÑÂêà„Çè„Åõ„Éï„Ç©„Éº„É†
                </a>
            </div>
        </div>

        <!-- „ÉÅ„É£„ÉÉ„Éà„Ç≥„É≥„ÉÜ„Éä -->
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <!-- „É°„ÉÉ„Çª„Éº„Ç∏„Åå„Åì„Åì„Å´ËøΩÂä†„Åï„Çå„Åæ„Åô -->
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>AI„ÅåÂõûÁ≠î„ÇíÁîüÊàê‰∏≠„Åß„Åô...</p>
            </div>
            
            <form class="chat-input" id="questionForm">
                <input type="text" id="question" placeholder="„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº„ÅÆÂïèÈ°å„Å´„Å§„ÅÑ„Å¶„ÅäËÅû„Åã„Åõ„Åè„Å†„Åï„ÅÑ..." required>
                <button type="submit" id="submitBtn">ÈÄÅ‰ø°</button>
            </form>
        </div>

        <!-- Èñ¢ÈÄ£„Éñ„É≠„Ç∞„Çª„ÇØ„Ç∑„Éß„É≥ -->
        <div class="related-blogs" id="relatedBlogs">
            <h3>üìù Èñ¢ÈÄ£„Éñ„É≠„Ç∞Ë®ò‰∫ã</h3>
            <div class="blog-grid" id="blogGrid">
                <!-- Èñ¢ÈÄ£„Éñ„É≠„Ç∞„Åå„Åì„Åì„Å´ËøΩÂä†„Åï„Çå„Åæ„Åô -->
            </div>
        </div>

        <!-- Èñ¢ÈÄ£„É™„É≥„ÇØ„Çª„ÇØ„Ç∑„Éß„É≥ -->
        <div class="links-section">
            <h3>üîó Èñ¢ÈÄ£„É™„É≥„ÇØ</h3>
            <a href="https://camper-repair.net/blog/" target="_blank">‰øÆÁêÜ„Çµ„Éù„Éº„Éà„Éñ„É≠„Ç∞</a>
            <a href="https://camper-repair.net/contact/" target="_blank">„ÅäÂïè„ÅÑÂêà„Çè„Åõ</a>
            <a href="https://camper-repair.net/" target="_blank">„Éõ„Éº„É†„Éö„Éº„Ç∏</a>
        </div>
    </div>

    <script>
      let conversationId = null;

      // Êñ∞„Åó„ÅÑ‰ºöË©±„ÇíÈñãÂßã„Åô„ÇãÈñ¢Êï∞
      async function startNewConversation() {
        try {
          const response = await fetch('/api/start_conversation', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            }
          });
          
          if (response.ok) {
            const data = await response.json();
            conversationId = data.conversation_id;
            console.log('Êñ∞„Åó„ÅÑ‰ºöË©±„ÇíÈñãÂßã:', conversationId);
          } else {
            console.error('‰ºöË©±ÈñãÂßã„Å´Â§±Êïó:', response.status);
          }
        } catch (error) {
          console.error('‰ºöË©±ÈñãÂßã„Ç®„É©„Éº:', error);
        }
      }

      // „É°„ÉÉ„Çª„Éº„Ç∏„ÇíËøΩÂä†„Åô„ÇãÈñ¢Êï∞
      function addMessage(content, isUser = true) {
        const chatMessages = document.getElementById('chatMessages');
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${isUser ? 'user-message' : 'ai-message'}`;
        
        // ÊîπË°å„Çí<br>„Çø„Ç∞„Å´Â§âÊèõ
        const formattedContent = content.replace(/\n/g, '<br>');
        messageDiv.innerHTML = formattedContent;
        
        chatMessages.appendChild(messageDiv);
        
        // „Çπ„ÇØ„É≠„Éº„É´„ÇíÊúÄ‰∏ãÈÉ®„Å´
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

       // Èñ¢ÈÄ£„Éñ„É≠„Ç∞„ÇíË°®Á§∫„Åô„ÇãÈñ¢Êï∞
       function showRelatedBlogs(blogs) {
         const blogSection = document.getElementById('relatedBlogs');
         const blogGrid = document.getElementById('blogGrid');
         
         if (!blogs || blogs.length === 0) {
           blogSection.style.display = 'none';
           return;
         }
         
                 blogGrid.innerHTML = '';
        
        // ÊúÄÂ§ß3‰ª∂„Åæ„ÅßË°®Á§∫
        const displayBlogs = blogs.slice(0, 3);
        
        displayBlogs.forEach(blog => {
           const blogCard = document.createElement('div');
           blogCard.className = 'blog-card';
           blogCard.onclick = () => window.open(blog.url, '_blank');
           
           blogCard.innerHTML = `
             <div class="blog-title">${blog.title}</div>
             <div class="blog-excerpt">${blog.excerpt}</div>
             <div class="blog-meta">
               <div class="blog-tags">
                 ${blog.tags.map(tag => `<span class="blog-tag">${tag}</span>`).join('')}
               </div>
               <div>${blog.date}</div>
             </div>
           `;
           
           blogGrid.appendChild(blogCard);
         });
         
                 blogSection.style.display = 'block';
        console.log('Èñ¢ÈÄ£„Éñ„É≠„Ç∞„ÇíË°®Á§∫:', displayBlogs.length, '‰ª∂');
      }

      // „Éñ„É≠„Ç∞„É™„É≥„ÇØ„ÇíË°®Á§∫„Åô„ÇãÈñ¢Êï∞Ôºà„Çµ„Éº„Éê„Éº„Åã„ÇâÂèñÂæóÔºâ
      function showBlogLinks(blogLinks) {
        const blogSection = document.getElementById('relatedBlogs');
        const blogGrid = document.getElementById('blogGrid');
        
        if (!blogLinks || blogLinks.length === 0) {
          blogSection.style.display = 'none';
          return;
        }
        
        blogGrid.innerHTML = '';
        
        // ÊúÄÂ§ß3‰ª∂„Åæ„ÅßË°®Á§∫
        const displayBlogs = blogLinks.slice(0, 3);
        
        displayBlogs.forEach(blog => {
          const blogCard = document.createElement('div');
          blogCard.className = 'blog-card';
          blogCard.onclick = () => window.open(blog.url, '_blank');
          
          blogCard.innerHTML = `
            <div class="blog-title">${blog.title}</div>
            <div class="blog-excerpt">${blog.excerpt}</div>
            <div class="blog-meta">
              <div class="blog-tags">
                ${blog.tags.map(tag => `<span class="blog-tag">${tag}</span>`).join('')}
              </div>
              <div>${blog.date}</div>
            </div>
          `;
          
          blogGrid.appendChild(blogCard);
        });
        
        blogSection.style.display = 'block';
        
        // „Éá„Éê„ÉÉ„Ç∞Áî®„É≠„Ç∞
        console.log('„Çµ„Éº„Éê„Éº„Åã„Çâ„Éñ„É≠„Ç∞„É™„É≥„ÇØ„ÇíË°®Á§∫:', blogLinks.length, '‰ª∂');
      }

               // „Éñ„É≠„Ç∞Ê§úÁ¥¢Ê©üËÉΩ
        function searchRelatedBlogs(query) {
          // ÂÆüÂú®„Åô„Çã„Éñ„É≠„Ç∞Ë®ò‰∫ã„ÅÆ„Åø
          const realBlogs = [
            {
              title: '„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº„ÅÆ„Çø„Ç§„É§ÈÅ∏„Å≥„Å®Á©∫Ê∞óÂúßÁÆ°ÁêÜ„ÅßÁü•„Çã„Åπ„Åç„Éù„Ç§„É≥„Éà„Å®„ÅØÔºü',
              excerpt: '„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº„ÅÆ„Çø„Ç§„É§ÈÅ∏„Å≥„Å®Á©∫Ê∞óÂúßÁÆ°ÁêÜ„Å´„Å§„ÅÑ„Å¶Ë©≥„Åó„ÅèËß£Ë™¨„Åó„Åæ„Åô„ÄÇ',
              tags: ['„Çø„Ç§„É§', 'Á©∫Ê∞óÂúß', 'ÁÆ°ÁêÜ'],
              date: '2025-08-10',
              url: 'https://camper-repair.net/blog/'
            },
            {
              title: '„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº„Å´ÊúÄÈÅ©„Å™„Ç®„Ç¢„Ç≥„É≥„Å®„ÅØÔºüÂÆ∂Â∫≠Áî®„Éª12V„Éª„Éù„Éº„Çø„Éñ„É´„ÅÆÈÅï„ÅÑ„ÇíËß£Ë™¨',
              excerpt: '„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº„Å´ÊúÄÈÅ©„Å™„Ç®„Ç¢„Ç≥„É≥„ÅÆÁ®ÆÈ°û„Å®ÈÅ∏„Å≥Êñπ„Å´„Å§„ÅÑ„Å¶Ë©≥„Åó„ÅèËß£Ë™¨„Åó„Åæ„Åô„ÄÇ',
              tags: ['„Ç®„Ç¢„Ç≥„É≥', '12V', '„Éù„Éº„Çø„Éñ„É´'],
              date: '2025-05-22',
              url: 'https://camper-repair.net/blog/'
            },
            {
              title: '„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº„ÅÆ„Ç®„Ç¢„Ç≥„É≥Âæå‰ªò„ÅëË≤ªÁî®„ÇÑÊ©üÁ®Æ„ÅÆÈÅ∏„Å≥Êñπ„Ç¨„Ç§„Éâ',
              excerpt: '„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº„ÅÆ„Ç®„Ç¢„Ç≥„É≥Âæå‰ªò„Åë„Å´Èñ¢„Åô„ÇãË≤ªÁî®„ÇÑÊ©üÁ®Æ„ÅÆÈÅ∏„Å≥Êñπ„Å´„Å§„ÅÑ„Å¶Ë™¨Êòé„Åó„Åæ„Åô„ÄÇ',
              tags: ['„Ç®„Ç¢„Ç≥„É≥', 'Âæå‰ªò„Åë', 'Ë≤ªÁî®'],
              date: '2025-05-08',
              url: 'https://camper-repair.net/blog/'
            },
            {
              title: '„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº„ÅÆ‰øùÈô∫ÂÆåÂÖ®„Ç¨„Ç§„ÉâÔΩúÂÆâÂøÉ„Åó„Å¶ÊóÖ„ÇíÊ•Ω„Åó„ÇÄ„Åü„ÇÅ„Å´Áü•„Å£„Å¶„Åä„Åè„Åπ„Åç„Åì„Å®',
              excerpt: '„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº‰øùÈô∫„Å´„Å§„ÅÑ„Å¶Ë©≥„Åó„ÅèËß£Ë™¨„Åó„Åæ„Åô„ÄÇ',
              tags: ['‰øùÈô∫', '„Ç¨„Ç§„Éâ', 'ÂÆâÂøÉ'],
              date: '2025-08-26',
              url: 'https://camper-repair.net/blog/'
            },
            {
              title: '„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº‰øùÈô∫„ÅØ„ÉÅ„É•„Éº„É™„ÉÉ„Éí„Å®„ÅØ „Ç™„Éº„Éä„Éº„ÅåÁü•„Çã„Åπ„Åç3„Å§„ÅÆÁêÜÁî±',
              excerpt: '„ÉÅ„É•„Éº„É™„ÉÉ„Éí„ÅÆ„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº‰øùÈô∫„Å´„Å§„ÅÑ„Å¶Ë™¨Êòé„Åó„Åæ„Åô„ÄÇ',
              tags: ['‰øùÈô∫', '„ÉÅ„É•„Éº„É™„ÉÉ„Éí', 'ÁêÜÁî±'],
              date: '2025-09-26',
              url: 'https://camper-repair.net/blog/'
            },
            {
              title: 'Êù±‰∫¨Êµ∑‰∏äÊó•Âãï„ÅÆ„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº‰øùÈô∫„ÅßÂÆâÂøÉ„ÅÆÊóÖ„ÇíÔºÅË£úÂÑüÂÜÖÂÆπ„Åã„ÇâÈÅ∏„Å≥Êñπ„Åæ„Åß',
              excerpt: 'Êù±‰∫¨Êµ∑‰∏äÊó•Âãï„ÅÆ„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº‰øùÈô∫„Å´„Å§„ÅÑ„Å¶Ë©≥„Åó„ÅèËß£Ë™¨„Åó„Åæ„Åô„ÄÇ',
              tags: ['‰øùÈô∫', 'Êù±‰∫¨Êµ∑‰∏äÊó•Âãï', 'Ë£úÂÑü'],
              date: '2025-09-22',
              url: 'https://camper-repair.net/blog/'
            }
          ];
         
                 // „ÇØ„Ç®„É™„Å´Âü∫„Å•„ÅÑ„Å¶Èñ¢ÈÄ£„Éñ„É≠„Ç∞„Çí„Éï„Ç£„É´„Çø„É™„É≥„Ç∞
        const relatedBlogs = realBlogs.filter(blog => {
          const searchTerms = query.toLowerCase().split(' ');
          const blogText = (blog.title + ' ' + blog.excerpt + ' ' + blog.tags.join(' ')).toLowerCase();
          
          // „Çà„ÇäÊüîËªü„Å™„Éû„ÉÉ„ÉÅ„É≥„Ç∞ÔºàÈÉ®ÂàÜ‰∏ÄËá¥„ÇÇÂê´„ÇÄÔºâ
          return searchTerms.some(term => {
            if (term.length < 2) return false; // 1ÊñáÂ≠ó„ÅÆÂçòË™û„ÅØÈô§Â§ñ
            return blogText.includes(term);
          });
        });
        
        // Èñ¢ÈÄ£„Éñ„É≠„Ç∞„ÇíË°®Á§∫
        showRelatedBlogs(relatedBlogs);
      }

      // „Ç™„Éï„É©„Ç§„É≥ÂõûÁ≠î„ÇíÂèñÂæó„Åô„ÇãÈñ¢Êï∞
      function getOfflineAnswer(question) {
        const lowerQuestion = question.toLowerCase();
        
        if (lowerQuestion.includes('„Éê„ÉÉ„ÉÜ„É™„Éº') || lowerQuestion.includes('ÂÖÖÈõª')) {
          return `„Éê„ÉÉ„ÉÜ„É™„ÉºÈñ¢ÈÄ£„ÅÆÂïèÈ°å„Åß„Åô„Å≠„ÄÇ‰∏ÄËà¨ÁöÑ„Å™ÂéüÂõ†„Å®„Åó„Å¶‰ª•‰∏ã„ÅåËÄÉ„Åà„Çâ„Çå„Åæ„ÅôÔºö

**‰∏ª„Å™ÂéüÂõ†Ôºö**
1. „Ç¢„Ç§„ÇΩ„É¨„Éº„Çø„Éº„ÅÆÊïÖÈöú
2. „Éê„ÉÉ„ÉÜ„É™„Éº„ÅÆÂä£Âåñ
3. ÈÖçÁ∑ö„ÅÆÊñ≠Á∑ö
4. ÂÖÖÈõªÂô®„ÅÆÊïÖÈöú

**Á¢∫Ë™çÊñπÊ≥ïÔºö**
- „Ç®„É≥„Ç∏„É≥ÂßãÂãïÊôÇ„ÅÆÂÖÖÈõªÈõªÂúß„ÇíÊ∏¨ÂÆöÔºà13.8V‰ª•‰∏ä„ÅåÊ≠£Â∏∏Ôºâ
- „Éê„ÉÉ„ÉÜ„É™„ÉºÁ´ØÂ≠ê„ÅÆÊ∏ÖÊéÉ
- ÈÖçÁ∑ö„ÅÆÊé•Á∂öÁ¢∫Ë™ç

Ë©≥Á¥∞„Å™Ë®∫Êñ≠„Å´„ÅØÂ∞ÇÈñÄÊ•≠ËÄÖ„Å∏„ÅÆÁõ∏Ë´á„Çí„ÅäÂãß„ÇÅ„Åó„Åæ„Åô„ÄÇ`;
        }
        
        if (lowerQuestion.includes('„Ç®„Ç¢„Ç≥„É≥') || lowerQuestion.includes('ÂÜ∑Êàø')) {
          return `„Ç®„Ç¢„Ç≥„É≥Èñ¢ÈÄ£„ÅÆÂïèÈ°å„Åß„Åô„Å≠„ÄÇ„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº„ÅÆ„Ç®„Ç¢„Ç≥„É≥„Åß„Çà„Åè„ÅÇ„ÇãÂïèÈ°å„ÅØÔºö

**‰∏ª„Å™ÂéüÂõ†Ôºö**
1. „Éï„Ç£„É´„Çø„Éº„ÅÆÊ±ö„Çå
2. ÂÜ∑Â™í„Ç¨„ÇπÊºè„Çå
3. ÂÆ§Â§ñÊ©ü„ÅÆÊ±ö„Çå
4. ÈõªÊ∫ê‰æõÁµ¶„ÅÆÂïèÈ°å

**ÂØæÂá¶Ê≥ïÔºö**
- „Éï„Ç£„É´„Çø„Éº„ÅÆÊ∏ÖÊéÉ„Éª‰∫§Êèõ
- ÂÆ§Â§ñÊ©ü„ÅÆÊ∏ÖÊéÉ
- ÈõªÊ∫êÈõªÂúß„ÅÆÁ¢∫Ë™ç

„Ç®„Ç¢„Ç≥„É≥„ÅÆÁ®ÆÈ°ûÔºàÂÆ∂Â∫≠Áî®„Éª12V„Éª„Éù„Éº„Çø„Éñ„É´Ôºâ„Å´„Çà„Å£„Å¶ÂØæÂá¶Ê≥ï„ÅåÁï∞„Å™„Çä„Åæ„Åô„ÄÇ`;
        }
        
        return `Áî≥„ÅóË®≥„Åî„Åñ„ÅÑ„Åæ„Åõ„Çì„Åå„ÄÅÁèæÂú®„Çµ„Éº„Éê„Éº„Å´Êé•Á∂ö„Åß„Åç„Åæ„Åõ„Çì„ÄÇ

‰∏ÄËà¨ÁöÑ„Å™„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº„ÅÆ‰øÆÁêÜ„Å´„Å§„ÅÑ„Å¶„ÄÅ‰ª•‰∏ã„ÅÆÁÇπ„Çí„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑÔºö

**Âü∫Êú¨„ÉÅ„Çß„ÉÉ„ÇØÈ†ÖÁõÆÔºö**
- „Éí„É•„Éº„Ç∫„ÅÆÁ¢∫Ë™ç
- ÈÖçÁ∑ö„ÅÆÊé•Á∂öÁä∂ÊÖã
- „Éê„ÉÉ„ÉÜ„É™„Éº„ÅÆÈõªÂúß
- ÂêÑÊ©üÂô®„ÅÆÈõªÊ∫ê‰æõÁµ¶

Ë©≥Á¥∞„Å™Ë®∫Êñ≠„Å´„ÅØ„ÄÅÂ∞ÇÈñÄÊ•≠ËÄÖ„Å∏„ÅÆ„ÅîÁõ∏Ë´á„Çí„ÅäÂãß„ÇÅ„Åó„Åæ„Åô„ÄÇ`;
      }

      // „Éï„Ç©„Éº„É†ÈÄÅ‰ø°Âá¶ÁêÜ
      document.getElementById('questionForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const question = document.getElementById('question').value.trim();
        if (!question) return;
        
        const submitBtn = document.getElementById('submitBtn');
        const loading = document.getElementById('loading');
        
        // UIÊõ¥Êñ∞
        submitBtn.disabled = true;
        loading.classList.add('show');
        
        // „É¶„Éº„Ç∂„Éº„É°„ÉÉ„Çª„Éº„Ç∏„ÇíËøΩÂä†
        addMessage(question, true);
        
        // ÂÖ•Âäõ„Éï„Ç£„Éº„É´„Éâ„Çí„ÇØ„É™„Ç¢
        document.getElementById('question').value = '';
        
        try {
          // „Çµ„Éº„Éê„Éº„Å´ÈÄÅ‰ø°
          const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              message: question,
              conversation_id: conversationId
            })
          });
          
          if (response.ok) {
            const data = await response.json();
            
            // AI„ÅÆÂõûÁ≠î„ÇíËøΩÂä†
            addMessage(data.response, false);
            
            // Èñ¢ÈÄ£„Éñ„É≠„Ç∞„ÇíË°®Á§∫Ôºà„Çµ„Éº„Éê„Éº„Åã„ÇâÂèñÂæó„Åó„ÅüÂ†¥ÂêàÔºâ
            if (data.blog_links && data.blog_links.length > 0) {
              showBlogLinks(data.blog_links);
            }
          } else {
            throw new Error('„Çµ„Éº„Éê„Éº„Ç®„É©„Éº: ' + response.status);
          }
          
        } catch (error) {
          console.error('„Ç®„É©„Éº:', error);
          
          // „Ç™„Éï„É©„Ç§„É≥Ê©üËÉΩ„Å®„Åó„Å¶Âü∫Êú¨ÁöÑ„Å™ÂõûÁ≠î„ÇíÊèê‰æõ
          const offlineAnswer = getOfflineAnswer(question);
          addMessage(offlineAnswer, false);
          
          // „Ç™„Éï„É©„Ç§„É≥ÂõûÁ≠îÂÜÖÂÆπ„Å´Èñ¢ÈÄ£„Åô„Çã„Éñ„É≠„Ç∞„ÇíÊ§úÁ¥¢„Åó„Å¶Ë°®Á§∫
          searchRelatedBlogs(offlineAnswer);
        } finally {
          // UIÂæ©ÂÖÉ
          submitBtn.disabled = false;
          loading.classList.remove('show');
        }
      });

      // Enter„Ç≠„Éº„ÅßÈÄÅ‰ø°
      document.getElementById('question').addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          document.getElementById('questionForm').dispatchEvent(new Event('submit'));
        }
      });

      // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„Å´Êñ∞„Åó„ÅÑ‰ºöË©±„ÇíÈñãÂßã
      document.addEventListener('DOMContentLoaded', function() {
        try {
          // Êñ∞„Åó„ÅÑ‰ºöË©±„ÇíÈñãÂßã
          startNewConversation();
          
          // ÂàùÊúü„É°„ÉÉ„Çª„Éº„Ç∏„ÇíË°®Á§∫
          setTimeout(() => {
            addMessage("„Åì„Çì„Å´„Å°„ÅØÔºÅ„Ç≠„É£„É≥„Éî„É≥„Ç∞„Ç´„Éº„ÅÆ‰øÆÁêÜ„Å´„Å§„ÅÑ„Å¶‰Ωï„Åß„ÇÇ„ÅäËÅû„Åã„Åõ„Åè„Å†„Åï„ÅÑ„ÄÇ„Ç®„É≥„Ç∏„É≥„ÅÆÂïèÈ°å„ÄÅÈõªÊ∞óÁ≥ªÁµ±„ÅÆÊïÖÈöú„ÄÅÁµ¶ÊéíÊ∞¥„ÅÆÂïèÈ°å„Å™„Å©„ÄÅ„Å©„Çì„Å™„Åì„Å®„Åß„ÇÇ„ÅäÊ∞óËªΩ„Å´„ÅîÁõ∏Ë´á„Åè„Å†„Åï„ÅÑ„ÄÇ", false);
          }, 500);
          
          // „Çµ„Éº„Éê„ÉºÊé•Á∂ö„ÉÜ„Çπ„Éà
          fetch('/api/health')
            .then(response => response.json())
            .then(data => console.log('„Çµ„Éº„Éê„ÉºÊé•Á∂öÁ¢∫Ë™ç:', data))
            .catch(error => console.log('„Çµ„Éº„Éê„ÉºÊé•Á∂ö„Ç®„É©„Éº:', error));
            
        } catch (error) {
          console.error('ÂàùÊúüÂåñ„Ç®„É©„Éº:', error);
        }
      });
    </script>
</body>
</html>